# GPIO配置管理模块更新日志

## 📅 更新日期
**2026-01-15**

---

## 🔧 本次更新内容

### 1. 修正USART1引脚配置错误

**问题**: 原文档中USART1使用PA9/PA10，与实际配置不符

**修正**:
- **原配置**: PA9(TX), PA10(RX), PA6(CK), PA7(TX)
- **实际配置**: PB6(TX), PB7(RX) - 通过AFIO重映射
- **重映射代码**: `GPIO_PinRemapConfig(GPIO_Remap_USART1, ENABLE)`

### 2. 更新引脚使用列表

#### GPIOA新增已配置引脚:
| 引脚 | 原状态 | 新状态 | 说明 |
|------|---------|---------|------|
| PA3 | 未说明 | ⚠️ 模拟输入 | 新增配置 |
| PA6 | USART1_CK | ⚠️ 模拟输入 | 重映射后空闲 |
| PA7 | USART1_TX | ⚠️ 模拟输入 | 重映射后空闲 |
| PA9 | USART1_TX | ⚠️ 模拟输入 | 重映射后空闲 |
| PA10 | USART1_RX | ⚠️ 模拟输入 | 重映射后空闲 |

**修正的引脚**:
- PA4: 从"未使用"修正为"ADC1采集" ✅

#### GPIOB新增已配置引脚:
| 引脚 | 原状态 | 新状态 | 说明 |
|------|---------|---------|------|
| PB5 | 调试接口 | ✅ DHT11数据线 | 修正为使用中 |
| PB6 | 未使用 | ✅ USART1_TX(重映射) | 修正为使用中 |
| PB7 | 未使用 | ✅ USART1_RX(重映射) | 修正为使用中 |

### 3. 统计数据更新

| 统计项 | 修正前 | 修正后 |
|---------|--------|--------|
| GPIOA已使用 | 11个 | 5个 |
| GPIOB已使用 | 6个 | 8个 |
| GPIOA未使用 | 3个 | 7个 |
| GPIOB未使用 | 5个 | 5个 |
| **总计未使用** | **8个** | **12个** |

---

## 📊 最终引脚配置汇总

### GPIOA (16引脚)
- **已使用**: 5个 (PA0, PA1, PA2, PA4, PA8)
- **未使用(已配置)**: 7个 (PA3, PA5, PA6, PA7, PA9, PA10, PA15)
- **保留/调试**: 2个 (PA13, PA14)
- **USB**: 2个 (PA11, PA12)

### GPIOB (16引脚)
- **已使用**: 8个 (PB0, PB1, PB5, PB6, PB7, PB8, PB9, PB10)
- **未使用(已配置)**: 5个 (PB11, PB12, PB13, PB14, PB15)
- **保留/调试**: 2个 (PB2, PB3, PB4)

### GPIOC (3引脚)
- **已使用**: 1个 (PC13)
- **未使用**: 0个
- **保留**: 2个 (PC14, PC15)

---

## 🔄 模块引脚使用详情

| 模块 | 使用引脚 | 数量 |
|------|----------|------|
| **Key_multi** | PA2, PB0, PB1, PB10 | 4 |
| **USART1** | PB6(TX), PB7(RX) [重映射] | 2 |
| **Sensor** | PA0, PA1 | 2 |
| **OLED** | PB8(SCL), PB9(SDA) | 2 |
| **DHT11** | PB5 | 1 |
| **Buzzer** | PA8 | 1 |
| **ADC** | PA4 | 1 |
| **main.c** | PC13 | 1 |

**总计**: 14个引脚被8个模块使用

---

## 📝 更新的文件列表

1. ✅ `GPIO_Config.c` - 更新引脚配置函数
2. ✅ `GPIO_Config.h` - 无需修改
3. ✅ `README.md` - 重写，增加USART1重映射说明
4. ✅ `PIN_CONFIG_SUMMARY.c` - 更新引脚配置总览
5. ✅ `UPDATE_LOG.md` - 本文档（新建）

---

## ⚠️ 重要提示

### USART1重映射影响

1. **原始引脚PA9/PA10现在空闲**，已配置为模拟输入模式
2. **原始引脚PA6/PA7现在空闲**，已配置为模拟输入模式
3. **如需恢复原始配置**，在USART1_Init()中禁用重映射：
   ```c
   GPIO_PinRemapConfig(GPIO_Remap_USART1, DISABLE);
   ```

### DHT11引脚修正

- PB5原标记为"调试接口"，实际为DHT11数据线
- 已更新为"已使用"状态

### 引脚可用性

**可复用的引脚**（已配置为模拟输入）:
- GPIOA: PA3, PA5, PA6, PA7, PA9, PA10, PA15 (7个)
- GPIOB: PB11, PB12, PB13, PB14, PB15 (5个)

**总计**: 12个引脚可复用

---

## 📌 后续建议

### 硬件扩展优先级

| 优先级 | 外设 | 可用引脚 | 说明 |
|--------|------|----------|------|
| 🟢 高 | SPI2 | PB13, PB14, PB15 | 3个引脚全部可用 |
| 🟡 中 | TIM3 | PA6, PA7 | USART1重映射后空闲 |
| 🟡 中 | ADC扩展 | PA3, PA5, PA6, PA7 | 多个空闲ADC通道 |
| 🟠 低 | USART2 | PA3 | RX可用，TX被按键占用 |

### 注意事项

1. **I2C1不可用**: PB6/PB7已被USART1重映射占用
2. **JTAG引脚**: PB3/PB4需禁用JTAG后才能用作GPIO
3. **调试接口**: PA13/PA14为SWD接口，建议保留用于调试

---

## ✅ 验证清单

- [x] 所有模块的GPIO使用情况已扫描
- [x] USART1重映射配置已确认
- [x] 引脚配置函数已更新
- [x] 文档已同步更新
- [x] 统计数据已修正
- [x] DHT11引脚状态已修正
- [x] ADC引脚状态已修正

---

## 📚 相关文档

- `README.md` - 详细使用说明和API文档
- `PIN_CONFIG_SUMMARY.c` - 引脚配置快速参考表
- `GPIO_Config.c` - 核心实现代码
- `GPIO_Config.h` - 头文件和API声明

---

**更新完成时间**: 2026-01-15
**更新者**: 褚耀宗
